Sprint 003 – 2025-10-12
=======================

Context
- Scope: Textual Inversion com componente nativo (sem repetir sprints anteriores).
- Flags: `GRADIO_EXTRA_NETWORKS_DATASET=1`.

Completed
- Extra Networks – Textual Inversion: `gr.Gallery` opcional com filtro/ordem server‑side; selecionar card adiciona o token ao prompt positivo da aba ativa.
- Docs/NEWS atualizados.
- GRADIO JS guardrails: `settings.js`/`ui.js` voltam a ser injetados por padrão e o filtro GRADIO_JS_* aborta se bloquear scripts essenciais (corrige layout, dropdowns vazios e queue crash).

Files touched (key)
- `modules/ui_extra_networks.py`
- `NEWS.md`, `codex/gradio5-migration-notes.md`
- `modules/ui_gradio_extensions.py`, `codex/sprint-logs/2025-10-12_sprint-003.md`

Validation
- Com a flag ligada, TI mostra galeria; filtro/ordem ajustam itens; selecionar card insere token no prompt.
- Sem a flag, comportamento anterior (HTML) preservado.
- Static review: verificado que o allowlist padrão contém `settings.js`/`ui.js`, denylist padrão é vazio e o guard lança `RuntimeError` quando algum essencial é filtrado. Sem ambiente Gradio instalável aqui, execução end-to-end fica pendente.

Risks / Follow-ups
- Avaliar UX para inserir no prompt negativo (atalho, botão ou opção); hoje insere no positivo por padrão.
- Generalizar Dataset/Gallery para outras páginas (LoRA) mantendo ações (copy path, metadata, edit item).
- Rodar smoke test da WebUI com dependências atualizadas para confirmar ausência de regressões quando as dependências estiverem disponíveis.

Next Sprint
- LoRA: protótipo de Dataset/Gallery e ação “inserir no prompt” similar ao TI.
